# 1D Bin Packing for AS/RS Height Optimization

## 專案概述

- 即時動態儲位指派情境：針對倉儲作業中有新貨物需要立刻入庫的情形，系統將即時為單一儲位群組（例如特定巷道或區域）的新進貨物推薦適當的儲存位置。目標是在不延誤自動化設備運轉的前提下，快速決定每件貨物應存放於哪個儲位，以平衡倉儲空間利用與取貨效率。
- 靜態批次儲位最佳化情境：針對較長時間尺度的入庫規劃或庫存重組，系統可在離線模式下對單一儲位群組內的多筆貨物安排最優儲位配置。目標是最佳化全局的儲位使用效率，包括提高空間利用率、降低未來取貨路徑距離以及避免某些區域過度集中存放導致作業瓶頸。  
以下面的示意圖為例：  
這是由9個小貨櫃所組成的大貨櫃，貨物由入口放進去後，系統會自動安排該將貨物放入哪個櫃子。

![schematic](./visualization/schematic.png)

## 功能特色

- 線上即時入庫: 模擬新貨物抵達時，系統採用 首次適應 (First Fit) 演算法，依照預設的儲位優先順序，為貨物尋找第一個可行的儲位 。
- 離線儲位重組: 在系統離峰時段，採用 最佳適應 (Best Fit) 演算法對所有儲位中的貨物進行重新整理 。此演算法會將貨物以高度優先排序，並嘗試將它們堆疊以最大化空間利用率，減少總體堆疊高度 。
- 貨物檢索: 可根據貨物 ID 從系統中搜尋並取回指定的貨物 。
- 3D 視覺化: 提供將任何一個儲位 (Bin) 的內部堆疊情況進行 3D 視覺化的功能，並可選擇在圖上顯示貨物 ID，方便分析與展示。

![3D_visualization](./bin_visualization.png)

## 專案結構
```
.  
└── AS-RS/  
    └── height_only/  
        ├── README.md  
        ├── ASRSManager.py         # ASRS 系統核心管理程式  
        ├── main.py                # 主程式進入點  
        ├── config.yaml            # 儲位尺寸與優先權設定檔  
        ├── items.csv              # 待入庫的貨物資料  
        ├── item.py                # 定義 Item 物件  
        ├── bin.py                 # 定義 Bin 物件  
        ├── utils.py               # 通用工具函式  
        ├── algorithms/            # 演算法資料夾  
        │   ├── best_fit.py  
        │   └── first_fit.py  
        └── visualization/         # 視覺化資料夾  
            └── visualization.py  
```

## 主要演算法:
若貨物能翻轉：將貨物翻轉至高度較低的情況。
若貨物無法翻轉：照貨物原樣放入櫃子

first fit:遍歷所有已放入貨物的櫃子，若有空間可以放入這個貨物就放入，若沒有的話就開一個新的櫃子。
best fit:先將貨物清單根據高度進行排序，從最高的貨物依序放入。遍歷所有已放入貨物的櫃子，並給予每個櫃子一個分數。分數的給法是：若櫃子放入這個貨物的話，剩餘的高度越少，分數越高，最後會把貨物放入分數最高的櫃子裡面。

## 執行：
1. 參數設定(config.yaml)：
    - bin_dimensions: 設定儲位的物理尺寸（寬、高、深）以及可調整的最小高度單位 。
    - online_priority: 設定線上作業時，系統嘗試放置貨物的儲位 ID 順序 。
    - offline_priority: 設定離線重組時，使用的儲位 ID 順序 。

2. 產生隨機貨物資料，或使給予指定格式之貨物資料csv檔案：
若要隨機產生貨物資料，執行以下檔案：
``` bash
# 產生隨機貨物清單
python ramdom_item.py
```

3. 執行主程式：
``` bash
# 各種使用範例皆在main.py中可參考
python main.py
```